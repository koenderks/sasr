<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Koen Derks">
<title>Statistical Audit Sampling with R - 5&nbsp; Selection</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<link href="./chap-evaluation.html" rel="next">
<link href="./chap-planning.html" rel="prev">
<link href="./front-page.png" rel="icon" type="image/png">
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><style>html{ scroll-behavior: smooth; }</style>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
<meta property="og:title" content="Statistical Audit Sampling with R - 5&nbsp; Selection">
<meta property="og:description" content="">
<meta property="og:image" content="https://koenderks.github.io/sasr/img/selection_random.png">
<meta property="og:site-name" content="Statistical Audit Sampling with R">
<meta property="og:image:height" content="62">
<meta property="og:image:width" content="475">
<meta name="twitter:title" content="Statistical Audit Sampling with R - 5&nbsp; Selection">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://koenderks.github.io/sasr/front-page.svg">
<meta name="twitter:card" content="summary_large_image">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./chap-workflow.html">Application</a></li><li class="breadcrumb-item"><a href="./chap-selection.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Selection</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Statistical Audit Sampling with R</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/koenderks/sasr/" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Statistical-Audit-Sampling-with-R.pdf">
              <i class="bi bi-bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Statistical-Audit-Sampling-with-R.epub">
              <i class="bi bi-bi-journal pe-1"></i>
            Download ePub
            </a>
          </li>
      </ul>
</div>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting Started</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Theory</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap-foundations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Statistics and Auditing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Statistical Inference</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Application</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap-workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Sampling Workflow</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap-planning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Planning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap-selection.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Selection</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap-evaluation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Evaluation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap-stratified-evaluation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Stratified Evaluation</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Software</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap-jasp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">JASP for Audit</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chap-packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">R Packages</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tutorial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Appendix: R Tutorial</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li>
<a href="#sampling-units" id="toc-sampling-units" class="nav-link active" data-scroll-target="#sampling-units"><span class="header-section-number">5.1</span> Sampling Units</a>
  <ul class="collapse">
<li><a href="#items" id="toc-items" class="nav-link" data-scroll-target="#items"><span class="header-section-number">5.1.1</span> Items</a></li>
  <li><a href="#monetary-units" id="toc-monetary-units" class="nav-link" data-scroll-target="#monetary-units"><span class="header-section-number">5.1.2</span> Monetary Units</a></li>
  </ul>
</li>
  <li>
<a href="#sampling-methods" id="toc-sampling-methods" class="nav-link" data-scroll-target="#sampling-methods"><span class="header-section-number">5.2</span> Sampling Methods</a>
  <ul class="collapse">
<li><a href="#random-sampling" id="toc-random-sampling" class="nav-link" data-scroll-target="#random-sampling"><span class="header-section-number">5.2.1</span> Random Sampling</a></li>
  <li><a href="#fixed-interval-sampling" id="toc-fixed-interval-sampling" class="nav-link" data-scroll-target="#fixed-interval-sampling"><span class="header-section-number">5.2.2</span> Fixed Interval Sampling</a></li>
  <li><a href="#cell-sampling" id="toc-cell-sampling" class="nav-link" data-scroll-target="#cell-sampling"><span class="header-section-number">5.2.3</span> Cell Sampling</a></li>
  <li><a href="#modified-sieve-sampling" id="toc-modified-sieve-sampling" class="nav-link" data-scroll-target="#modified-sieve-sampling"><span class="header-section-number">5.2.4</span> Modified Sieve Sampling</a></li>
  </ul>
</li>
  <li><a href="#practical-exercises" id="toc-practical-exercises" class="nav-link" data-scroll-target="#practical-exercises"><span class="header-section-number">5.3</span> Practical Exercises</a></li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/koenderks/sasr/edit/master/chap-selection.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/koenderks/sasr/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="chap-selection" class="quarto-section-identifier"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Selection</span></span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p>Auditors must often evaluate balances or populations that include a large quantity of items. As it is not possible to individually examine all of these items, they must select a subset, or sample, from the total population to make a statement about a specific characteristic of the population. Several selection methodologies, which are widely accepted in the audit context, are available for this purpose. This chapter discusses the most frequently used sampling methodology for audit sampling and demonstrates how to select a sample using these methods in R.</p>
<section id="sampling-units" class="level2" data-number="5.1"><h2 data-number="5.1" class="anchored" data-anchor-id="sampling-units">
<span class="header-section-number">5.1</span> Sampling Units</h2>
<p>Selecting a subset from the population requires knowledge of the sampling units; physical representations of the population that needs to be audited. Generally, the auditor has to choose between two types of sampling units: individual items in the population or individual monetary units in the population. In order to perform statistical selection, the population must be divided into individual sampling units that can be assigned a probability to be included in the sample. The total collection of all sampling units which have been assigned a selection probability is called the sampling frame.</p>
<section id="items" class="level3" data-number="5.1.1"><h3 data-number="5.1.1" class="anchored" data-anchor-id="items">
<span class="header-section-number">5.1.1</span> Items</h3>
<p>A sampling unit for record (i.e., attributes) sampling is generally a characteristic of an item in the population. For example, suppose that you inspect a population of receipts. A possible sampling unit for record sampling can be the date of payment of the receipt. When a sampling unit (e.g., date of payment) is selected by the sampling method, the population item that corresponds to the sampled unit is included in the sample.</p>
</section><section id="monetary-units" class="level3" data-number="5.1.2"><h3 data-number="5.1.2" class="anchored" data-anchor-id="monetary-units">
<span class="header-section-number">5.1.2</span> Monetary Units</h3>
<p>A sampling unit for monetary unit sampling is different than a sampling unit for record sampling in that it is an individual monetary unit within an item or transaction, like an individual dollar. For example, a single sampling unit can be the 10<span class="math inline">\(^{th}\)</span> dollar from a specific receipt in the population. When a sampling unit (e.g., individual dollar) is selected by the sampling method, the population item that includes the sampling unit is included in the sample.</p>
</section></section><section id="sampling-methods" class="level2" data-number="5.2"><h2 data-number="5.2" class="anchored" data-anchor-id="sampling-methods">
<span class="header-section-number">5.2</span> Sampling Methods</h2>
<p>This section discusses four sampling methods that are commonly used in audit sampling. The methods that will be discussed are:</p>
<ul>
<li>Random sampling</li>
<li>Fixed interval sampling</li>
<li>Cell sampling</li>
<li>Modified sieve sampling</li>
</ul>
<p>First, let’s get some notation out of the way. As discussed in Chapter 2, the population size <span class="math inline">\(N\)</span> is defined as the total set of individual sampling units (denoted by <span class="math inline">\(x_i\)</span>).</p>
<p><span class="math display">\[\begin{equation}
  N = \{x_1, x_2, \dots, x_N\}.
\end{equation}\]</span></p>
<p>In statistical sampling, every sampling unit <span class="math inline">\(x_i\)</span> in the population should receive a selection probability <span class="math inline">\(p(x_i)\)</span>. The purpose of the sampling method is to provide a framework to assign selection probabilities to each of the sampling units, and subsequently draw sampling units from the population until a set of size <span class="math inline">\(n\)</span> has been created.</p>
<p>To illustrate how the resulting sample differs for various sampling methods, we will use the <code>BuildIt</code> data set included in the <strong>jfa</strong> package. These data can be loaded into R using the code below. For simplicity, we will use a sample size of <span class="math inline">\(n = 10\)</span> for all examples.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">BuildIt</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="random-sampling" class="level3" data-number="5.2.1"><h3 data-number="5.2.1" class="anchored" data-anchor-id="random-sampling">
<span class="header-section-number">5.2.1</span> Random Sampling</h3>
<p>Random sampling is the most simple and straight-forward selection method. The random sampling method provides a method that allows every sampling unit in the population an equal chance of being selected, meaning that every combination of sampling units has the same probability of being selected as every other combination of the same number of sampling units. Simply put, the algorithm draws a random selection of size <span class="math inline">\(n\)</span> of the sampling units. Therefore, the selection probability for each sampling unit is defined as:</p>
<p><span class="math display">\[\begin{equation}
  p(x) = \frac{1}{N}.
\end{equation}\]</span></p>
<p>To make this procedure visually intuitive, <a href="#fig-selection-random">Figure&nbsp;<span>5.1</span></a> below provides an illustration of the random sampling method.</p>
<div id="fig-selection-random" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="img/selection_random.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;5.1: Illustration of random sampling, which involves selecting a subset of items from a population in such a way that every sampling unit in the population has an equal chance of being included in the sample.</figcaption></figure>
</div>
<ul>
<li>
<strong>Advantage(s):</strong> The random sampling method yields an optimal random selection, with the additional advantage that the sample can be easily extended by applying the same method again.</li>
<li>
<strong>Disadvantages:</strong> Because the selection probabilities are equal for all sampling units there is no guarantee that items with a large monetary value in the population will be included in the sample.</li>
</ul>
<section id="record-sampling" class="level4" data-number="5.2.1.1"><h4 data-number="5.2.1.1" class="anchored" data-anchor-id="record-sampling">
<span class="header-section-number">5.2.1.1</span> Record Sampling</h4>
<p>Random sampling can easily be coded in base R. First, we have to get a vector of of the possible items (rows) in the population that can be selected. When we are performing record sampling, we can simply use R’s build in <code><a href="https://rdrr.io/r/base/sample.html">sample()</a></code> function to draw a random sample from a vector <code>1:nrow(BuildIt)</code> representing the row indices of the items and store the result in a variable <code>items</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">items</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">BuildIt</span><span class="op">)</span>, size <span class="op">=</span> <span class="va">n</span>, replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">items</span></span>
<span><span class="co">#&gt;  [1] 1017  679 2177  930 1533  471 2347  270 1211 3379</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can then select the sample from the population using the selected indices stored in <code>items</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">BuildIt</span><span class="op">[</span><span class="va">items</span>, <span class="op">]</span></span>
<span><span class="co">#&gt;         ID bookValue auditValue</span></span>
<span><span class="co">#&gt; 1017 50755    618.24     618.24</span></span>
<span><span class="co">#&gt; 679  20237    669.75     669.75</span></span>
<span><span class="co">#&gt; 2177  9517    454.02     454.02</span></span>
<span><span class="co">#&gt; 930  85674    257.82     257.82</span></span>
<span><span class="co">#&gt; 1533 31051    308.53     308.53</span></span>
<span><span class="co">#&gt; 471  84375    824.66     824.66</span></span>
<span><span class="co">#&gt; 2347 75616    623.70     623.70</span></span>
<span><span class="co">#&gt; 270  82033    352.75     352.75</span></span>
<span><span class="co">#&gt; 1211 12877     52.89      52.89</span></span>
<span><span class="co">#&gt; 3379 85322    330.24     330.24</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The sample can be reproduced in <strong>jfa</strong> via the <code>selection()</code> function. This function takes as input the population data, the sample size, and the characteristics of the sampling method. The argument <code>units</code> allows you to specify that you want to use record sampling (<code>units = "items"</code>), while the <code>method</code> argument enables you to specify that you are performing random sampling (<code>method = 'random'</code>).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">selection</span><span class="op">(</span>data <span class="op">=</span> <span class="va">BuildIt</span>, size <span class="op">=</span> <span class="va">n</span>, units <span class="op">=</span> <span class="st">"items"</span>, method <span class="op">=</span> <span class="st">"random"</span><span class="op">)</span></span>
<span><span class="va">result</span><span class="op">$</span><span class="va">sample</span></span>
<span><span class="co">#&gt;     row times    ID bookValue auditValue</span></span>
<span><span class="co">#&gt; 1  1017     1 50755    618.24     618.24</span></span>
<span><span class="co">#&gt; 2   679     1 20237    669.75     669.75</span></span>
<span><span class="co">#&gt; 3  2177     1  9517    454.02     454.02</span></span>
<span><span class="co">#&gt; 4   930     1 85674    257.82     257.82</span></span>
<span><span class="co">#&gt; 5  1533     1 31051    308.53     308.53</span></span>
<span><span class="co">#&gt; 6   471     1 84375    824.66     824.66</span></span>
<span><span class="co">#&gt; 7  2347     1 75616    623.70     623.70</span></span>
<span><span class="co">#&gt; 8   270     1 82033    352.75     352.75</span></span>
<span><span class="co">#&gt; 9  1211     1 12877     52.89      52.89</span></span>
<span><span class="co">#&gt; 10 3379     1 85322    330.24     330.24</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>An alternative to specifying the desired sample size through the <code>size</code> argument is to provide an object generated by the <code>planning()</code> function to the <code>selection()</code> function. For instance, the following code utilizes the <code>planning()</code> function to plan a sample size based on a performance materiality of 3 percent and a sampling risk of 5 percent, which can be passed directly to <code>selection()</code> to select the sample from the <code>BuildIt</code> population.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plan</span> <span class="op">&lt;-</span> <span class="fu">planning</span><span class="op">(</span>materiality <span class="op">=</span> <span class="fl">0.03</span><span class="op">)</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">selection</span><span class="op">(</span>data <span class="op">=</span> <span class="va">BuildIt</span>, size <span class="op">=</span> <span class="va">plan</span>, units <span class="op">=</span> <span class="st">"items"</span>, method <span class="op">=</span> <span class="st">"random"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The ability of one function to accept input from another function allows for the implementation of a workflow in which the <code>planning()</code> function and the <code>selection()</code> function are sequentially linked. Additionally, the use of R’s native pipe operator <code>|&gt;</code> further simplifies this process.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">planning</span><span class="op">(</span>materiality <span class="op">=</span> <span class="fl">0.03</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">selection</span><span class="op">(</span>data <span class="op">=</span> <span class="va">BuildIt</span>, units <span class="op">=</span> <span class="st">"items"</span>, method <span class="op">=</span> <span class="st">"random"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>selection()</code> function has three additional arguments which you can use to preprocess your population before selection. These arguments are <code>order</code>, <code>decreasing</code> and <code>randomize</code>.</p>
<p>The <code>order</code> argument takes as input a column name in <code>data</code> which determines the order of the population. For example, you can order the population from lowest book value to highest book value before engaging in the selection. In this case, you should use the <code>decreasing = FALSE</code> (its default value) argument.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">selection</span><span class="op">(</span>data <span class="op">=</span> <span class="va">BuildIt</span>, size <span class="op">=</span> <span class="va">n</span>, units <span class="op">=</span> <span class="st">"items"</span>, method <span class="op">=</span> <span class="st">"random"</span>, order <span class="op">=</span> <span class="st">"bookValue"</span><span class="op">)</span></span>
<span><span class="va">result</span><span class="op">$</span><span class="va">sample</span></span>
<span><span class="co">#&gt;     row times    ID bookValue auditValue</span></span>
<span><span class="co">#&gt; 1    29     1 58849    274.26     274.26</span></span>
<span><span class="co">#&gt; 2  3297     1 24279    229.95     229.95</span></span>
<span><span class="co">#&gt; 3   931     1 28025    429.14     429.14</span></span>
<span><span class="co">#&gt; 4   756     1 11563    263.08     105.23</span></span>
<span><span class="co">#&gt; 5  3375     1 58981    335.39     335.39</span></span>
<span><span class="co">#&gt; 6  1624     1 97783    197.19     197.19</span></span>
<span><span class="co">#&gt; 7  2534     1 95715    457.42     457.42</span></span>
<span><span class="co">#&gt; 8  1798     1 95520    157.54     157.54</span></span>
<span><span class="co">#&gt; 9  3448     1 12959    296.82     296.82</span></span>
<span><span class="co">#&gt; 10  450     1 39908    831.31     831.31</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>randomize</code> argument can be used to randomly shuffle the items in the population before selection. For example, you can randomly shuffle the population before engaging in the selection using <code>randomize = TRUE</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">selection</span><span class="op">(</span>data <span class="op">=</span> <span class="va">BuildIt</span>, size <span class="op">=</span> <span class="va">n</span>, units <span class="op">=</span> <span class="st">"items"</span>, method <span class="op">=</span> <span class="st">"random"</span>, randomize <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">result</span><span class="op">$</span><span class="va">sample</span></span>
<span><span class="co">#&gt;     row times    ID bookValue auditValue</span></span>
<span><span class="co">#&gt; 1  1264     1 85424    406.81     406.81</span></span>
<span><span class="co">#&gt; 2   923     1 12566    287.61     287.61</span></span>
<span><span class="co">#&gt; 3   776     1 92923    247.89     247.89</span></span>
<span><span class="co">#&gt; 4   127     1 71325    306.78     306.78</span></span>
<span><span class="co">#&gt; 5  1611     1 10019    191.18     191.18</span></span>
<span><span class="co">#&gt; 6  3087     1 87887    666.13     666.13</span></span>
<span><span class="co">#&gt; 7  1729     1 78779    608.02     608.02</span></span>
<span><span class="co">#&gt; 8  2037     1 74155    347.18     347.18</span></span>
<span><span class="co">#&gt; 9  2769     1 26010    240.10     240.10</span></span>
<span><span class="co">#&gt; 10 2276     1 80154    282.91     282.91</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="monetary-unit-sampling" class="level4" data-number="5.2.1.2"><h4 data-number="5.2.1.2" class="anchored" data-anchor-id="monetary-unit-sampling">
<span class="header-section-number">5.2.1.2</span> Monetary Unit Sampling</h4>
<p>When we are performing record sampling, we have to consider that each item in the population consists of multiple smaller items (i.e., the monetary units), which means that items with a higher book value should get a higher probability of being selected. The <code><a href="https://rdrr.io/r/base/sample.html">sample()</a></code> function faciliates weighted selection via the <code>prob</code> argument, which takes a vector of values and, using normalization, computes the weights for selection. The call below is similar to before, but in this case we use the book values in the column <code>bookValues</code> of the data set to weigh the items and store the result in a variable <code>items</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">items</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">BuildIt</span><span class="op">)</span>, size <span class="op">=</span> <span class="va">n</span>, replace <span class="op">=</span> <span class="cn">FALSE</span>, prob <span class="op">=</span> <span class="va">BuildIt</span><span class="op">$</span><span class="va">bookValue</span><span class="op">)</span></span>
<span><span class="va">items</span></span>
<span><span class="co">#&gt;  [1] 2174 2928 1627  700  147 3056 3118 2045 1311  716</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can then select the sample from the population using the selected indices stored in <code>items</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">BuildIt</span><span class="op">[</span><span class="va">items</span>, <span class="op">]</span></span>
<span><span class="co">#&gt;         ID bookValue auditValue</span></span>
<span><span class="co">#&gt; 2174 90260    625.98     625.98</span></span>
<span><span class="co">#&gt; 2928 68595    548.21     548.21</span></span>
<span><span class="co">#&gt; 1627 98301    429.07     429.07</span></span>
<span><span class="co">#&gt; 700  29683    239.26     239.26</span></span>
<span><span class="co">#&gt; 147  72906    677.62     677.62</span></span>
<span><span class="co">#&gt; 3056 86317    246.22     246.22</span></span>
<span><span class="co">#&gt; 3118 14548    204.63     204.63</span></span>
<span><span class="co">#&gt; 2045 45416    381.05     381.05</span></span>
<span><span class="co">#&gt; 1311 91955    398.96     398.96</span></span>
<span><span class="co">#&gt; 716  12815    873.43     873.43</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The sample can be reproduced in <strong>jfa</strong> via the <code>selection()</code> function. The argument <code>units</code> allows you to specify that you want to use monetary unit sampling (<code>units = "values"</code>), while the <code>method</code> argument enables you to specify that you are performing random sampling (<code>method = 'random'</code>). Note that you should provide the name of the column in the data that contains the monetary units via the <code>values</code> argument.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">selection</span><span class="op">(</span>data <span class="op">=</span> <span class="va">BuildIt</span>, size <span class="op">=</span> <span class="va">n</span>, units <span class="op">=</span> <span class="st">"values"</span>, method <span class="op">=</span> <span class="st">"random"</span>, values <span class="op">=</span> <span class="st">"bookValue"</span><span class="op">)</span></span>
<span><span class="va">result</span><span class="op">$</span><span class="va">sample</span></span>
<span><span class="co">#&gt;     row times    ID bookValue auditValue</span></span>
<span><span class="co">#&gt; 1  2174     1 90260    625.98     625.98</span></span>
<span><span class="co">#&gt; 2  2928     1 68595    548.21     548.21</span></span>
<span><span class="co">#&gt; 3  1627     1 98301    429.07     429.07</span></span>
<span><span class="co">#&gt; 4   700     1 29683    239.26     239.26</span></span>
<span><span class="co">#&gt; 5   147     1 72906    677.62     677.62</span></span>
<span><span class="co">#&gt; 6  3056     1 86317    246.22     246.22</span></span>
<span><span class="co">#&gt; 7  3118     1 14548    204.63     204.63</span></span>
<span><span class="co">#&gt; 8  2045     1 45416    381.05     381.05</span></span>
<span><span class="co">#&gt; 9  1311     1 91955    398.96     398.96</span></span>
<span><span class="co">#&gt; 10  716     1 12815    873.43     873.43</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="fixed-interval-sampling" class="level3" data-number="5.2.2"><h3 data-number="5.2.2" class="anchored" data-anchor-id="fixed-interval-sampling">
<span class="header-section-number">5.2.2</span> Fixed Interval Sampling</h3>
<p>Fixed interval sampling is a method designed for yielding representative samples from monetary populations. The algorithm determines a uniform interval on the (optionally ranked) sampling units. Next, a starting point is handpicked or randomly selected in the first interval and a sampling unit is selected throughout the population at each of the uniform intervals from the starting point. For example, if the interval has a width of 10 sampling units and sampling unit number 5 is chosen as the starting point, the sampling units 5, 15, 25, etc. are selected to be included in the sample.</p>
<p>The number of required intervals <span class="math inline">\(I\)</span> can be determined by dividing the number of sampling units in the population by the required sample size:</p>
<p><span class="math display">\[\begin{equation}
  I = \frac{N}{n},
\end{equation}\]</span></p>
<p>in which <span class="math inline">\(n\)</span> is the required sample size and <span class="math inline">\(N\)</span> is the total number of sampling units in the population.</p>
<p>If the space between the selected sampling units is equal, the selection probability for each sampling unit is theoretically defined as:</p>
<p><span class="math display">\[\begin{equation}
  p(x) = \frac{1}{I},
\end{equation}\]</span></p>
<p>with the property that the space between selected units <span class="math inline">\(i\)</span> (of which the first one is the starting point) is the same as the interval <span class="math inline">\(I\)</span>, see @#fig-selection-interval below. However, in practice the selection is deterministic and completely depends on the chosen starting points (using <code>start</code>).</p>
<div id="fig-selection-interval" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="img/selection_interval.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;5.2: Illustration of fixed interval sampling. The population is represented by the horizontal line, and the vertical lines indicate the intervals of size <span class="math inline">\(I\)</span> at which samples units are selected. By using fixed interval sampling, equal spacing between sampling units is ensures, which means that every <span class="math inline">\(\text{i}^{\text{th}}\)</span> unit in the population is included in the sample.</figcaption></figure>
</div>
<p>The fixed interval method yields a sample that allows every sampling unit in the population an equal chance of being selected. However, the fixed interval method has the property that all items in the population with a monetary value larger than the interval <span class="math inline">\(I\)</span> have an selection probability of one because one of these items’ sampling units are always selected from the interval. Note that, if the population is arranged randomly with respect to its deviation pattern, fixed interval sampling is equivalent to random selection.</p>
<ul>
<li>
<strong>Advantage(s):</strong> The advantage of the fixed interval sampling method is that it is often simple to understand and fast to perform. Another advantage is that, in monetary unit sampling, all items that are greater than the calculated interval will be included in the sample. In record sampling, since units can be ranked on the basis of value, there is also a guarantee that some large items will be in the sample.</li>
<li>
<strong>Disadvantage(s):</strong> A pattern in the population can coincide with the selected interval, rendering the sample less representative. What is sometimes seen as an added complication for this method is that the sample is hard to extend after drawing the initial sample. This is due to the chance of selecting the same sampling unit. However, by removing the already selected sampling units from the population and redrawing the intervals this problem can be efficiently solved.</li>
</ul>
<section id="record-sampling-1" class="level4" data-number="5.2.2.1"><h4 data-number="5.2.2.1" class="anchored" data-anchor-id="record-sampling-1">
<span class="header-section-number">5.2.2.1</span> Record Sampling</h4>
<p>To code fixed interval sampling in a record sampling context, we first have to compute the size of the interval we are working with. This is computed by dividing the number of items in the population by the desired sample size <span class="math inline">\(n\)</span>. Suppose the auditor wants to select a sample of 10 items, then the interval is computed by:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">interval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">BuildIt</span><span class="op">)</span> <span class="op">/</span> <span class="va">n</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we have to determine the starting point. We are going to take the fifth unit in each interval in this case.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">start</span> <span class="op">&lt;-</span> <span class="fl">5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To find which rows are part of the sample, we execute the following code:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">items</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">floor</a></span><span class="op">(</span><span class="va">start</span> <span class="op">+</span> <span class="va">interval</span> <span class="op">*</span> <span class="fl">0</span><span class="op">:</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can then select the sample from the population using the selected indices stored in <code>items</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">BuildIt</span><span class="op">[</span><span class="va">items</span>, <span class="op">]</span></span>
<span><span class="co">#&gt;         ID bookValue auditValue</span></span>
<span><span class="co">#&gt; 5    55080    620.88     620.88</span></span>
<span><span class="co">#&gt; 355  27934    749.38     749.38</span></span>
<span><span class="co">#&gt; 705  21900    919.00     919.00</span></span>
<span><span class="co">#&gt; 1055 66675    384.27     384.27</span></span>
<span><span class="co">#&gt; 1405 13472    360.05     360.05</span></span>
<span><span class="co">#&gt; 1755 61607    389.75     389.75</span></span>
<span><span class="co">#&gt; 2105 68519    354.71     354.71</span></span>
<span><span class="co">#&gt; 2455 91983    467.72     467.72</span></span>
<span><span class="co">#&gt; 2805 25646    420.80     420.80</span></span>
<span><span class="co">#&gt; 3155 94955    248.77     248.77</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The sample can be reproduced in <strong>jfa</strong> via the <code>selection()</code> function. The argument <code>units</code> allows you to specify that you want to use record sampling (<code>units = "items"</code>), while the <code>method</code> argument enables you to specify that you are performing fixed interval sampling (<code>method = 'interval'</code>). Note that, by default, the first sampling unit from each interval is selected. However, this can be changed by setting the argument <code>start</code> to a different value.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">selection</span><span class="op">(</span>data <span class="op">=</span> <span class="va">BuildIt</span>, size <span class="op">=</span> <span class="va">n</span>, units <span class="op">=</span> <span class="st">"items"</span>, method <span class="op">=</span> <span class="st">"interval"</span>, start <span class="op">=</span> <span class="va">start</span><span class="op">)</span></span>
<span><span class="va">result</span><span class="op">$</span><span class="va">sample</span></span>
<span><span class="co">#&gt;     row times    ID bookValue auditValue</span></span>
<span><span class="co">#&gt; 1     5     1 55080    620.88     620.88</span></span>
<span><span class="co">#&gt; 2   355     1 27934    749.38     749.38</span></span>
<span><span class="co">#&gt; 3   705     1 21900    919.00     919.00</span></span>
<span><span class="co">#&gt; 4  1055     1 66675    384.27     384.27</span></span>
<span><span class="co">#&gt; 5  1405     1 13472    360.05     360.05</span></span>
<span><span class="co">#&gt; 6  1755     1 61607    389.75     389.75</span></span>
<span><span class="co">#&gt; 7  2105     1 68519    354.71     354.71</span></span>
<span><span class="co">#&gt; 8  2455     1 91983    467.72     467.72</span></span>
<span><span class="co">#&gt; 9  2805     1 25646    420.80     420.80</span></span>
<span><span class="co">#&gt; 10 3155     1 94955    248.77     248.77</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="monetary-unit-sampling-1" class="level4" data-number="5.2.2.2"><h4 data-number="5.2.2.2" class="anchored" data-anchor-id="monetary-unit-sampling-1">
<span class="header-section-number">5.2.2.2</span> Monetary Unit Sampling</h4>
<p>In monetary unit sampling, the only difference is that we are computing the interval on the basis of the booked values in the column <code>bookValue</code> of the data set. In this case, the starting point <code>start = 5</code> determines which monetary unit from each interval is selected.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">interval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">BuildIt</span><span class="op">$</span><span class="va">bookValue</span><span class="op">)</span> <span class="op">/</span> <span class="va">n</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To find which units are part of the sample, we execute the following code:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">units</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">floor</a></span><span class="op">(</span><span class="va">start</span> <span class="op">+</span> <span class="va">interval</span> <span class="op">*</span> <span class="fl">0</span><span class="op">:</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To obtain which items are part of the sample, we can run the following for loop. Note that this does not take into account whether the book values contain negative values, which should not be included in the cumulative sum below.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">all_units</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">BuildIt</span><span class="op">$</span><span class="va">bookValue</span> <span class="op">&lt;</span> <span class="fl">0</span>, <span class="fl">0</span>, <span class="va">BuildIt</span><span class="op">$</span><span class="va">bookValue</span><span class="op">)</span></span>
<span><span class="va">all_items</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">BuildIt</span><span class="op">)</span></span>
<span><span class="va">items</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">item</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">units</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">all_units</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">items</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">all_items</span><span class="op">[</span><span class="va">item</span><span class="op">]</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can then select the sample from the population using the selected indices stored in <code>items</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">BuildIt</span><span class="op">[</span><span class="va">items</span>, <span class="op">]</span></span>
<span><span class="co">#&gt;         ID bookValue auditValue</span></span>
<span><span class="co">#&gt; 1    82884    242.61     242.61</span></span>
<span><span class="co">#&gt; 358  20711    610.88     610.88</span></span>
<span><span class="co">#&gt; 715  99012    313.75     313.75</span></span>
<span><span class="co">#&gt; 1081 65319    502.54     201.02</span></span>
<span><span class="co">#&gt; 1421 88454    856.28     856.28</span></span>
<span><span class="co">#&gt; 1774 87258    157.68     157.68</span></span>
<span><span class="co">#&gt; 2103 48652    497.21     497.21</span></span>
<span><span class="co">#&gt; 2435 37248   1041.44    1041.44</span></span>
<span><span class="co">#&gt; 2787 10925    377.10     377.10</span></span>
<span><span class="co">#&gt; 3152 71832   1001.82    1001.82</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The sample can be reproduced in <strong>jfa</strong> via the <code>selection()</code> function. The argument <code>units</code> allows you to specify that you want to use monetary unit sampling (<code>units = "values"</code>), while the <code>method</code> argument enables you to specify that you are performing fixed interval sampling (<code>method = 'interval'</code>). Note that you should provide the name of the column in the data that contains the monetary units via the <code>values</code> argument.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">selection</span><span class="op">(</span>data <span class="op">=</span> <span class="va">BuildIt</span>, size <span class="op">=</span> <span class="va">n</span>, units <span class="op">=</span> <span class="st">"values"</span>, method <span class="op">=</span> <span class="st">"interval"</span>, values <span class="op">=</span> <span class="st">"bookValue"</span>, start <span class="op">=</span> <span class="va">start</span><span class="op">)</span></span>
<span><span class="va">result</span><span class="op">$</span><span class="va">sample</span></span>
<span><span class="co">#&gt;     row times    ID bookValue auditValue</span></span>
<span><span class="co">#&gt; 1     1     1 82884    242.61     242.61</span></span>
<span><span class="co">#&gt; 2   358     1 20711    610.88     610.88</span></span>
<span><span class="co">#&gt; 3   715     1 99012    313.75     313.75</span></span>
<span><span class="co">#&gt; 4  1081     1 65319    502.54     201.02</span></span>
<span><span class="co">#&gt; 5  1421     1 88454    856.28     856.28</span></span>
<span><span class="co">#&gt; 6  1774     1 87258    157.68     157.68</span></span>
<span><span class="co">#&gt; 7  2103     1 48652    497.21     497.21</span></span>
<span><span class="co">#&gt; 8  2435     1 37248   1041.44    1041.44</span></span>
<span><span class="co">#&gt; 9  2787     1 10925    377.10     377.10</span></span>
<span><span class="co">#&gt; 10 3152     1 71832   1001.82    1001.82</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="cell-sampling" class="level3" data-number="5.2.3"><h3 data-number="5.2.3" class="anchored" data-anchor-id="cell-sampling">
<span class="header-section-number">5.2.3</span> Cell Sampling</h3>
<p>The cell sampling method divides the (optionally ranked) population into a set of intervals <span class="math inline">\(I\)</span> that are computed through the previously given equations. Within each interval, a sampling unit is selected by randomly drawing a number between 1 and the interval range <span class="math inline">\(I\)</span>. This causes the space <span class="math inline">\(i\)</span> between the sampling units to vary. The procedure is displayed in @#fig-selection-cell.</p>
<p>Like in the fixed interval sampling method, the selection probability for each sampling unit is defined as:</p>
<p><span class="math display">\[\begin{equation}
  p(x) = \frac{1}{I}.
\end{equation}\]</span></p>
<div id="fig-selection-cell" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="img/selection_cell.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;5.3: Illustration of cell sampling. In this illustration, the population is fist divided into distinct cells of size <span class="math inline">\(I\)</span> and subsequently a random sampling unit is selected within each cell such that the space between units <span class="math inline">\(i\)</span> varies.</figcaption></figure>
</div>
<p>The cell sampling method has the property that all items in the population with a monetary value larger than twice the interval <span class="math inline">\(I\)</span> have a selection probability of one.</p>
<ul>
<li>
<strong>Advantage(s):</strong> More sets of samples are possible than in fixed interval sampling, as there is no systematic interval <span class="math inline">\(i\)</span> to determine the selections. It is argued that the cell sampling algorithm offers a solution to the pattern problem in fixed interval sampling.</li>
<li>
<strong>Disadvantage(s):</strong> A disadvantage of this sampling method is that not all items in the population with a monetary value larger than the interval have a selection probability of one. Besides, population items can be in two adjacent cells, thereby creating the possibility that an items is included in the sample twice.</li>
</ul>
<section id="record-sampling-2" class="level4" data-number="5.2.3.1"><h4 data-number="5.2.3.1" class="anchored" data-anchor-id="record-sampling-2">
<span class="header-section-number">5.2.3.1</span> Record Sampling</h4>
<p>To code cell sampling in a record sampling context, we again have to compute the size of the interval we are working with:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">interval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">BuildIt</span><span class="op">)</span> <span class="op">/</span> <span class="va">n</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we have to randomly determine which items are going to be selected in each interval.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">starts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">0</span>, <span class="va">interval</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To find which rows are part of the sample, we execute the following code:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">items</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">floor</a></span><span class="op">(</span><span class="va">starts</span> <span class="op">+</span> <span class="va">interval</span> <span class="op">*</span> <span class="fl">0</span><span class="op">:</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can then select the sample from the population using the selected indices stored in <code>items</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">BuildIt</span><span class="op">[</span><span class="va">items</span>, <span class="op">]</span></span>
<span><span class="co">#&gt;         ID bookValue auditValue</span></span>
<span><span class="co">#&gt; 92   75133    355.16     355.16</span></span>
<span><span class="co">#&gt; 480  81037    456.27     456.27</span></span>
<span><span class="co">#&gt; 900   1730    449.87     449.87</span></span>
<span><span class="co">#&gt; 1367 36587    282.32     282.32</span></span>
<span><span class="co">#&gt; 1470 10305    648.70     648.70</span></span>
<span><span class="co">#&gt; 2064 96344    268.94     268.94</span></span>
<span><span class="co">#&gt; 2430 60885    493.77     493.77</span></span>
<span><span class="co">#&gt; 2681 60935    312.98     312.98</span></span>
<span><span class="co">#&gt; 3020  8716    450.76     450.76</span></span>
<span><span class="co">#&gt; 3171 61036    387.67     387.67</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The sample can be reproduced in <strong>jfa</strong> via the <code>selection()</code> function. The argument <code>units</code> allows you to specify that you want to use record sampling (<code>units = "items"</code>), while the <code>method</code> argument enables you to specify that you are performing cell sampling (<code>method = 'cell'</code>).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">selection</span><span class="op">(</span>data <span class="op">=</span> <span class="va">BuildIt</span>, size <span class="op">=</span> <span class="va">n</span>, units <span class="op">=</span> <span class="st">"items"</span>, method <span class="op">=</span> <span class="st">"cell"</span><span class="op">)</span></span>
<span><span class="va">result</span><span class="op">$</span><span class="va">sample</span></span>
<span><span class="co">#&gt;     row times    ID bookValue auditValue</span></span>
<span><span class="co">#&gt; 1    92     1 75133    355.16     355.16</span></span>
<span><span class="co">#&gt; 2   480     1 81037    456.27     456.27</span></span>
<span><span class="co">#&gt; 3   900     1  1730    449.87     449.87</span></span>
<span><span class="co">#&gt; 4  1367     1 36587    282.32     282.32</span></span>
<span><span class="co">#&gt; 5  1470     1 10305    648.70     648.70</span></span>
<span><span class="co">#&gt; 6  2064     1 96344    268.94     268.94</span></span>
<span><span class="co">#&gt; 7  2430     1 60885    493.77     493.77</span></span>
<span><span class="co">#&gt; 8  2681     1 60935    312.98     312.98</span></span>
<span><span class="co">#&gt; 9  3020     1  8716    450.76     450.76</span></span>
<span><span class="co">#&gt; 10 3171     1 61036    387.67     387.67</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="monetary-unit-sampling-2" class="level4" data-number="5.2.3.2"><h4 data-number="5.2.3.2" class="anchored" data-anchor-id="monetary-unit-sampling-2">
<span class="header-section-number">5.2.3.2</span> Monetary Unit Sampling</h4>
<p>In monetary unit sampling, the only difference is that we are computing the interval on the basis of the booked values in the column <code>bookValue</code> of the data set. In this case, the starting points <code>start</code> determines which monetary unit from each interval is selected.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">interval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">BuildIt</span><span class="op">$</span><span class="va">bookValue</span><span class="op">)</span> <span class="op">/</span> <span class="va">n</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To obtain which items are part of the sample, we can run the following for loop. Note that this does not take into account whether the book values contain negative values, which should not be included in the cumulative sum below.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">all_units</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">BuildIt</span><span class="op">$</span><span class="va">bookValue</span> <span class="op">&lt;</span> <span class="fl">0</span>, <span class="fl">0</span>, <span class="va">BuildIt</span><span class="op">$</span><span class="va">bookValue</span><span class="op">)</span></span>
<span><span class="va">all_items</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">BuildIt</span><span class="op">)</span></span>
<span><span class="va">intervals</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="va">n</span> <span class="op">*</span> <span class="va">interval</span></span>
<span><span class="va">items</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">unit</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">intervals</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">intervals</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">item</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">unit</span> <span class="op">&lt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">all_units</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">items</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">all_items</span><span class="op">[</span><span class="va">item</span><span class="op">]</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can then select the sample from the population using the selected indices stored in <code>items</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">BuildIt</span><span class="op">[</span><span class="va">items</span>, <span class="op">]</span></span>
<span><span class="co">#&gt;         ID bookValue auditValue</span></span>
<span><span class="co">#&gt; 95   15009    415.60     415.60</span></span>
<span><span class="co">#&gt; 486  79093    635.85     635.85</span></span>
<span><span class="co">#&gt; 931  28025    429.14     429.14</span></span>
<span><span class="co">#&gt; 1387 56444    296.37     296.37</span></span>
<span><span class="co">#&gt; 1492 81443    543.80     543.80</span></span>
<span><span class="co">#&gt; 2074 14196    270.45     270.45</span></span>
<span><span class="co">#&gt; 2418 87743    347.99     347.99</span></span>
<span><span class="co">#&gt; 2660 23927    454.81     454.81</span></span>
<span><span class="co">#&gt; 3024 78925    251.44     251.44</span></span>
<span><span class="co">#&gt; 3172 18286    450.57     450.57</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The sample can be reproduced in <strong>jfa</strong> via the <code>selection()</code> function. The argument <code>units</code> allows you to specify that you want to use monetary unit sampling (<code>units = "values"</code>), while the <code>method</code> argument enables you to specify that you are performing cell sampling (<code>method = 'cell'</code>). Note that you should provide the name of the column in the data that contains the monetary units via the <code>values</code> argument.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">selection</span><span class="op">(</span>data <span class="op">=</span> <span class="va">BuildIt</span>, size <span class="op">=</span> <span class="va">n</span>, units <span class="op">=</span> <span class="st">"values"</span>, method <span class="op">=</span> <span class="st">"cell"</span>, values <span class="op">=</span> <span class="st">"bookValue"</span><span class="op">)</span></span>
<span><span class="va">result</span><span class="op">$</span><span class="va">sample</span></span>
<span><span class="co">#&gt;     row times    ID bookValue auditValue</span></span>
<span><span class="co">#&gt; 1    95     1 15009    415.60     415.60</span></span>
<span><span class="co">#&gt; 2   486     1 79093    635.85     635.85</span></span>
<span><span class="co">#&gt; 3   931     1 28025    429.14     429.14</span></span>
<span><span class="co">#&gt; 4  1387     1 56444    296.37     296.37</span></span>
<span><span class="co">#&gt; 5  1492     1 81443    543.80     543.80</span></span>
<span><span class="co">#&gt; 6  2074     1 14196    270.45     270.45</span></span>
<span><span class="co">#&gt; 7  2418     1 87743    347.99     347.99</span></span>
<span><span class="co">#&gt; 8  2660     1 23927    454.81     454.81</span></span>
<span><span class="co">#&gt; 9  3024     1 78925    251.44     251.44</span></span>
<span><span class="co">#&gt; 10 3172     1 18286    450.57     450.57</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="modified-sieve-sampling" class="level3" data-number="5.2.4"><h3 data-number="5.2.4" class="anchored" data-anchor-id="modified-sieve-sampling">
<span class="header-section-number">5.2.4</span> Modified Sieve Sampling</h3>
<p>The fourth option for the sampling method is modified sieve sampling (Hoogduin, Hall, &amp; Tsay, 2010). The algorithm starts by selecting a standard uniform random number <span class="math inline">\(R_i\)</span> between 0 and 1 for each item in the population. Next, the sieve ratio:</p>
<p><span class="math display">\[\begin{equation}
  S_i = \frac{Y_i}{R_i}
\end{equation}\]</span></p>
<p>is computed for each item by dividing the book value of that item by the random number. Lastly, the items in the population are sorted by their sieve ratio <span class="math inline">\(S\)</span> (in decreasing order) and the top <span class="math inline">\(n\)</span> items are selected for inspection. In contrast to the classical sieve sampling method (Rietveld, 1978), the modified sieve sampling method provides precise control over sample sizes.</p>
<section id="monetary-unit-sampling-3" class="level4" data-number="5.2.4.1"><h4 data-number="5.2.4.1" class="anchored" data-anchor-id="monetary-unit-sampling-3">
<span class="header-section-number">5.2.4.1</span> Monetary Unit Sampling</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">all_units</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">BuildIt</span><span class="op">$</span><span class="va">bookValue</span> <span class="op">&lt;</span> <span class="fl">0</span>, <span class="fl">0</span>, <span class="va">BuildIt</span><span class="op">$</span><span class="va">bookValue</span><span class="op">)</span></span>
<span><span class="va">all_items</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">BuildIt</span><span class="op">)</span></span>
<span><span class="va">ri</span> <span class="op">&lt;-</span> <span class="va">all_units</span> <span class="op">/</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">all_items</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">items</span> <span class="op">&lt;-</span> <span class="va">all_items</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="op">-</span><span class="va">ri</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">items</span> <span class="op">&lt;-</span> <span class="va">items</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can then select the sample from the population using the selected indices stored in <code>items</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">BuildIt</span><span class="op">[</span><span class="va">items</span>, <span class="op">]</span></span>
<span><span class="co">#&gt;         ID bookValue auditValue</span></span>
<span><span class="co">#&gt; 2329 29919    681.10     681.10</span></span>
<span><span class="co">#&gt; 2883 59402    279.29     279.29</span></span>
<span><span class="co">#&gt; 1949 56012    581.22     581.22</span></span>
<span><span class="co">#&gt; 3065 47482    621.73     621.73</span></span>
<span><span class="co">#&gt; 1072 79901    789.97     789.97</span></span>
<span><span class="co">#&gt; 488  50811    651.35     651.35</span></span>
<span><span class="co">#&gt; 1916 53565    266.37     266.37</span></span>
<span><span class="co">#&gt; 463  65768    480.89     480.89</span></span>
<span><span class="co">#&gt; 1311 91955    398.96     398.96</span></span>
<span><span class="co">#&gt; 2895  8688    492.02     492.02</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The sample can be reproduced in <strong>jfa</strong> via the <code>selection()</code> function. The argument <code>units</code> allows you to specify that you want to use monetary unit sampling (<code>units = "values"</code>), while the <code>method</code> argument enables you to specify that you are performing modified sieve sampling (<code>method = 'sieve'</code>). Note that you should provide the name of the column in the data that contains the monetary units via the <code>values</code> argument.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">selection</span><span class="op">(</span>data <span class="op">=</span> <span class="va">BuildIt</span>, size <span class="op">=</span> <span class="va">n</span>, units <span class="op">=</span> <span class="st">"values"</span>, method <span class="op">=</span> <span class="st">"sieve"</span>, values <span class="op">=</span> <span class="st">"bookValue"</span><span class="op">)</span></span>
<span><span class="va">result</span><span class="op">$</span><span class="va">sample</span></span>
<span><span class="co">#&gt;     row times    ID bookValue auditValue</span></span>
<span><span class="co">#&gt; 1  2329     1 29919    681.10     681.10</span></span>
<span><span class="co">#&gt; 2  2883     1 59402    279.29     279.29</span></span>
<span><span class="co">#&gt; 3  1949     1 56012    581.22     581.22</span></span>
<span><span class="co">#&gt; 4  3065     1 47482    621.73     621.73</span></span>
<span><span class="co">#&gt; 5  1072     1 79901    789.97     789.97</span></span>
<span><span class="co">#&gt; 6   488     1 50811    651.35     651.35</span></span>
<span><span class="co">#&gt; 7  1916     1 53565    266.37     266.37</span></span>
<span><span class="co">#&gt; 8   463     1 65768    480.89     480.89</span></span>
<span><span class="co">#&gt; 9  1311     1 91955    398.96     398.96</span></span>
<span><span class="co">#&gt; 10 2895     1  8688    492.02     492.02</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section></section><section id="practical-exercises" class="level2" data-number="5.3"><h2 data-number="5.3" class="anchored" data-anchor-id="practical-exercises">
<span class="header-section-number">5.3</span> Practical Exercises</h2>
<ol type="1">
<li>Select a random sample of 120 items from the <code>BuildIt</code> data set.</li>
</ol>
<details><summary>
Click to reveal answer
</summary><p>Selecting a random sample of items can be done using the <code>selection()</code> function with the additional arguments <code>size = 120</code>, <code>method = "random"</code> and <code>units = "items"</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">selec</span> <span class="op">&lt;-</span> <span class="fu">selection</span><span class="op">(</span>data <span class="op">=</span> <span class="va">BuildIt</span>, size <span class="op">=</span> <span class="fl">120</span>, method <span class="op">=</span> <span class="st">"random"</span>, units <span class="op">=</span> <span class="st">"items"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">selec</span><span class="op">$</span><span class="va">sample</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;    row times    ID bookValue auditValue</span></span>
<span><span class="co">#&gt; 1 2453     1 95755    295.58     295.58</span></span>
<span><span class="co">#&gt; 2 2914     1 86541    470.99     470.99</span></span>
<span><span class="co">#&gt; 3  301     1 61726    588.81     588.81</span></span>
<span><span class="co">#&gt; 4 2632     1  3335    237.32     237.32</span></span>
<span><span class="co">#&gt; 5 1579     1 62317    309.74     309.74</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details><ol start="2" type="1">
<li>Select a sample of 240 monetary units from the <code>BuildIt</code> data set using a fixed interval selection method. Use a starting point of 12.</li>
</ol>
<details><summary>
Click to reveal answer
</summary><p>Selecting a random sample of items can be done using the <code>selection()</code> function with the arguments <code>size = 240</code>, <code>method = "interval"</code> and <code>units = "values"</code>. Additionally, for fixed interval monetary unit sampling, the book values must be given in via argument <code>values = "bookValue"</code>. The starting point is indicated using <code>start = 12</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">selec</span> <span class="op">&lt;-</span> <span class="fu">selection</span><span class="op">(</span>data <span class="op">=</span> <span class="va">BuildIt</span>, size <span class="op">=</span> <span class="fl">240</span>, method <span class="op">=</span> <span class="st">"interval"</span>, units <span class="op">=</span> <span class="st">"values"</span>, values <span class="op">=</span> <span class="st">"bookValue"</span>, start <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">selec</span><span class="op">$</span><span class="va">sample</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;   row times    ID bookValue auditValue</span></span>
<span><span class="co">#&gt; 1   1     1 82884    242.61     242.61</span></span>
<span><span class="co">#&gt; 2  15     1 76073    469.93     469.93</span></span>
<span><span class="co">#&gt; 3  31     1 83557    507.34     507.34</span></span>
<span><span class="co">#&gt; 4  47     1 53784    325.19     325.19</span></span>
<span><span class="co">#&gt; 5  63     1 51272    248.40     248.40</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>

<!-- -->

</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./chap-planning.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Planning</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./chap-evaluation.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Evaluation</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb36" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo = FALSE, cache = FALSE}</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"utils.R"</span>, <span class="at">local =</span> <span class="cn">TRUE</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="fu"># Selection {#chap-selection}</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>Auditors must often evaluate balances or populations that include a large quantity of items. As it is not possible to individually examine all of these items, they must select a subset, or sample, from the total population to make a statement about a specific characteristic of the population. Several selection methodologies, which are widely accepted in the audit context, are available for this purpose. This chapter discusses the most frequently used sampling methodology for audit sampling and demonstrates how to select a sample using these methods in R.</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sampling Units</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>Selecting a subset from the population requires knowledge of the sampling units; physical representations of the population that needs to be audited. Generally, the auditor has to choose between two types of sampling units: individual items in the population or individual monetary units in the population. In order to perform statistical selection, the population must be divided into individual sampling units that can be assigned a probability to be included in the sample. The total collection of all sampling units which have been assigned a selection probability is called the sampling frame.</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a><span class="fu">### Items</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>A sampling unit for record (i.e., attributes) sampling is generally a characteristic of an item in the population. For example, suppose that you inspect a population of receipts. A possible sampling unit for record sampling can be the date of payment of the receipt. When a sampling unit (e.g., date of payment) is selected by the sampling method, the population item that corresponds to the sampled unit is included in the sample.</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a><span class="fu">### Monetary Units</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>A sampling unit for monetary unit sampling is different than a sampling unit for record sampling in that it is an individual monetary unit within an item or transaction, like an individual dollar. For example, a single sampling unit can be the 10$^{th}$ dollar from a specific receipt in the population. When a sampling unit (e.g., individual dollar) is selected by the sampling method, the population item that includes the sampling unit is included in the sample.</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sampling Methods</span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>This section discusses four sampling methods that are commonly used in audit sampling. The methods that will be discussed are:</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Random sampling</span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Fixed interval sampling</span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Cell sampling</span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Modified sieve sampling</span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>First, let's get some notation out of the way. As discussed in Chapter 2, the population size $N$ is defined as the total set of individual sampling units (denoted by $x_i$).</span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>\begin{equation}</span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>  N = <span class="sc">\{</span>x_1, x_2, \dots, x_N<span class="sc">\}</span>.</span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>\end{equation}</span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a>In statistical sampling, every sampling unit $x_i$ in the population should receive a selection probability $p(x_i)$. The purpose of the sampling method is to provide a framework to assign selection probabilities to each of the sampling units, and subsequently draw sampling units from the population until a set of size $n$ has been created.</span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a>To illustrate how the resulting sample differs for various sampling methods, we will use the <span class="in">`BuildIt`</span> data set included in the **jfa** package. These data can be loaded into R using the code below. For simplicity, we will use a sample size of $n = 10$ for all examples.</span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(BuildIt)</span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a><span class="fu">### Random Sampling</span></span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true" tabindex="-1"></a>Random sampling is the most simple and straight-forward selection method. The random sampling method provides a method that allows every sampling unit in the population an equal chance of being selected, meaning that every combination of sampling units has the same probability of being selected as every other combination of the same number of sampling units. Simply put, the algorithm draws a random selection of size $n$ of the sampling units. Therefore, the selection probability for each sampling unit is defined as:</span>
<span id="cb36-50"><a href="#cb36-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-51"><a href="#cb36-51" aria-hidden="true" tabindex="-1"></a>\begin{equation}</span>
<span id="cb36-52"><a href="#cb36-52" aria-hidden="true" tabindex="-1"></a>  p(x) = \frac{1}{N}.</span>
<span id="cb36-53"><a href="#cb36-53" aria-hidden="true" tabindex="-1"></a>\end{equation}</span>
<span id="cb36-54"><a href="#cb36-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-55"><a href="#cb36-55" aria-hidden="true" tabindex="-1"></a>To make this procedure visually intuitive, @fig-selection-random below provides an illustration of the random sampling method.</span>
<span id="cb36-56"><a href="#cb36-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-57"><a href="#cb36-57" aria-hidden="true" tabindex="-1"></a><span class="al">![Illustration of random sampling, which involves selecting a subset of items from a population in such a way that every sampling unit in the population has an equal chance of being included in the sample. ](img/selection_random.png)</span>{#fig-selection-random fig-align="center"}</span>
<span id="cb36-58"><a href="#cb36-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-59"><a href="#cb36-59" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Advantage(s):** The random sampling method yields an optimal random selection, with the additional advantage that the sample can be easily extended by applying the same method again.</span>
<span id="cb36-60"><a href="#cb36-60" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Disadvantages:** Because the selection probabilities are equal for all sampling units there is no guarantee that items with a large monetary value in the population will be included in the sample.</span>
<span id="cb36-61"><a href="#cb36-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-62"><a href="#cb36-62" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Record Sampling</span></span>
<span id="cb36-63"><a href="#cb36-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-64"><a href="#cb36-64" aria-hidden="true" tabindex="-1"></a>Random sampling can easily be coded in base R. First, we have to get a vector of of the possible items (rows) in the population that can be selected. When we are performing record sampling, we can simply use R's build in <span class="in">`sample()`</span> function to draw a random sample from a vector <span class="in">`1:nrow(BuildIt)`</span> representing the row indices of the items and store the result in a variable <span class="in">`items`</span>.</span>
<span id="cb36-65"><a href="#cb36-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-68"><a href="#cb36-68" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-69"><a href="#cb36-69" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb36-70"><a href="#cb36-70" aria-hidden="true" tabindex="-1"></a>items <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(BuildIt), <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb36-71"><a href="#cb36-71" aria-hidden="true" tabindex="-1"></a>items</span>
<span id="cb36-72"><a href="#cb36-72" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-73"><a href="#cb36-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-74"><a href="#cb36-74" aria-hidden="true" tabindex="-1"></a>You can then select the sample from the population using the selected indices stored in <span class="in">`items`</span>.</span>
<span id="cb36-75"><a href="#cb36-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-78"><a href="#cb36-78" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-79"><a href="#cb36-79" aria-hidden="true" tabindex="-1"></a>BuildIt[items, ]</span>
<span id="cb36-80"><a href="#cb36-80" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-81"><a href="#cb36-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-82"><a href="#cb36-82" aria-hidden="true" tabindex="-1"></a>The sample can be reproduced in **jfa** via the <span class="in">`selection()`</span> function. This function takes as input the population data, the sample size, and the characteristics of the sampling method. The argument <span class="in">`units`</span> allows you to specify that you want to use record sampling (<span class="in">`units = "items"`</span>), while the <span class="in">`method`</span> argument enables you to specify that you are performing random sampling (<span class="in">`method = 'random'`</span>).</span>
<span id="cb36-83"><a href="#cb36-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-86"><a href="#cb36-86" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-87"><a href="#cb36-87" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb36-88"><a href="#cb36-88" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">selection</span>(<span class="at">data =</span> BuildIt, <span class="at">size =</span> n, <span class="at">units =</span> <span class="st">"items"</span>, <span class="at">method =</span> <span class="st">"random"</span>)</span>
<span id="cb36-89"><a href="#cb36-89" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>sample</span>
<span id="cb36-90"><a href="#cb36-90" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-91"><a href="#cb36-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-92"><a href="#cb36-92" aria-hidden="true" tabindex="-1"></a>An alternative to specifying the desired sample size through the <span class="in">`size`</span> argument is to provide an object generated by the <span class="in">`planning()`</span> function to the <span class="in">`selection()`</span> function. For instance, the following code utilizes the <span class="in">`planning()`</span> function to plan a sample size based on a performance materiality of 3 percent and a sampling risk of 5 percent, which can be passed directly to <span class="in">`selection()`</span> to select the sample from the <span class="in">`BuildIt`</span> population.</span>
<span id="cb36-93"><a href="#cb36-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-96"><a href="#cb36-96" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-97"><a href="#cb36-97" aria-hidden="true" tabindex="-1"></a>plan <span class="ot">&lt;-</span> <span class="fu">planning</span>(<span class="at">materiality =</span> <span class="fl">0.03</span>)</span>
<span id="cb36-98"><a href="#cb36-98" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">selection</span>(<span class="at">data =</span> BuildIt, <span class="at">size =</span> plan, <span class="at">units =</span> <span class="st">"items"</span>, <span class="at">method =</span> <span class="st">"random"</span>)</span>
<span id="cb36-99"><a href="#cb36-99" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-100"><a href="#cb36-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-101"><a href="#cb36-101" aria-hidden="true" tabindex="-1"></a>The ability of one function to accept input from another function allows for the implementation of a workflow in which the <span class="in">`planning()`</span> function and the <span class="in">`selection()`</span> function are sequentially linked. Additionally, the use of R's native pipe operator <span class="in">`|&gt;`</span> further simplifies this process.</span>
<span id="cb36-102"><a href="#cb36-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-105"><a href="#cb36-105" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-106"><a href="#cb36-106" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">planning</span>(<span class="at">materiality =</span> <span class="fl">0.03</span>) <span class="sc">|&gt;</span></span>
<span id="cb36-107"><a href="#cb36-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">selection</span>(<span class="at">data =</span> BuildIt, <span class="at">units =</span> <span class="st">"items"</span>, <span class="at">method =</span> <span class="st">"random"</span>)</span>
<span id="cb36-108"><a href="#cb36-108" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-109"><a href="#cb36-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-110"><a href="#cb36-110" aria-hidden="true" tabindex="-1"></a>The <span class="in">`selection()`</span> function has three additional arguments which you can use to preprocess your population before selection. These arguments are <span class="in">`order`</span>, <span class="in">`decreasing`</span> and <span class="in">`randomize`</span>.</span>
<span id="cb36-111"><a href="#cb36-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-112"><a href="#cb36-112" aria-hidden="true" tabindex="-1"></a>The <span class="in">`order`</span> argument takes as input a column name in <span class="in">`data`</span> which determines the order of the population. For example, you can order the population from lowest book value to highest book value before engaging in the selection. In this case, you should use the <span class="in">`decreasing = FALSE`</span> (its default value) argument.</span>
<span id="cb36-113"><a href="#cb36-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-116"><a href="#cb36-116" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-117"><a href="#cb36-117" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb36-118"><a href="#cb36-118" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">selection</span>(<span class="at">data =</span> BuildIt, <span class="at">size =</span> n, <span class="at">units =</span> <span class="st">"items"</span>, <span class="at">method =</span> <span class="st">"random"</span>, <span class="at">order =</span> <span class="st">"bookValue"</span>)</span>
<span id="cb36-119"><a href="#cb36-119" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>sample</span>
<span id="cb36-120"><a href="#cb36-120" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-121"><a href="#cb36-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-122"><a href="#cb36-122" aria-hidden="true" tabindex="-1"></a>The <span class="in">`randomize`</span> argument can be used to randomly shuffle the items in the population before selection. For example, you can randomly shuffle the population before engaging in the selection using <span class="in">`randomize = TRUE`</span>.</span>
<span id="cb36-123"><a href="#cb36-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-126"><a href="#cb36-126" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-127"><a href="#cb36-127" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb36-128"><a href="#cb36-128" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">selection</span>(<span class="at">data =</span> BuildIt, <span class="at">size =</span> n, <span class="at">units =</span> <span class="st">"items"</span>, <span class="at">method =</span> <span class="st">"random"</span>, <span class="at">randomize =</span> <span class="cn">TRUE</span>)</span>
<span id="cb36-129"><a href="#cb36-129" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>sample</span>
<span id="cb36-130"><a href="#cb36-130" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-131"><a href="#cb36-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-132"><a href="#cb36-132" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Monetary Unit Sampling</span></span>
<span id="cb36-133"><a href="#cb36-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-134"><a href="#cb36-134" aria-hidden="true" tabindex="-1"></a>When we are performing record sampling, we have to consider that each item in the population consists of multiple smaller items (i.e., the monetary units), which means that items with a higher book value should get a higher probability of being selected. The <span class="in">`sample()`</span> function faciliates weighted selection via the <span class="in">`prob`</span> argument, which takes a vector of values and, using normalization, computes the weights for selection. The call below is similar to before, but in this case we use the book values in the column <span class="in">`bookValues`</span> of the data set to weigh the items and store the result in a variable <span class="in">`items`</span>.</span>
<span id="cb36-135"><a href="#cb36-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-138"><a href="#cb36-138" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-139"><a href="#cb36-139" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb36-140"><a href="#cb36-140" aria-hidden="true" tabindex="-1"></a>items <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(BuildIt), <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">FALSE</span>, <span class="at">prob =</span> BuildIt<span class="sc">$</span>bookValue)</span>
<span id="cb36-141"><a href="#cb36-141" aria-hidden="true" tabindex="-1"></a>items</span>
<span id="cb36-142"><a href="#cb36-142" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-143"><a href="#cb36-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-144"><a href="#cb36-144" aria-hidden="true" tabindex="-1"></a>You can then select the sample from the population using the selected indices stored in <span class="in">`items`</span>.</span>
<span id="cb36-145"><a href="#cb36-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-148"><a href="#cb36-148" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-149"><a href="#cb36-149" aria-hidden="true" tabindex="-1"></a>BuildIt[items, ]</span>
<span id="cb36-150"><a href="#cb36-150" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-151"><a href="#cb36-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-152"><a href="#cb36-152" aria-hidden="true" tabindex="-1"></a>The sample can be reproduced in **jfa** via the <span class="in">`selection()`</span> function. The argument <span class="in">`units`</span> allows you to specify that you want to use monetary unit sampling (<span class="in">`units = "values"`</span>), while the <span class="in">`method`</span> argument enables you to specify that you are performing random sampling (<span class="in">`method = 'random'`</span>). Note that you should provide the name of the column in the data that contains the monetary units via the <span class="in">`values`</span> argument.</span>
<span id="cb36-153"><a href="#cb36-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-156"><a href="#cb36-156" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-157"><a href="#cb36-157" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb36-158"><a href="#cb36-158" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">selection</span>(<span class="at">data =</span> BuildIt, <span class="at">size =</span> n, <span class="at">units =</span> <span class="st">"values"</span>, <span class="at">method =</span> <span class="st">"random"</span>, <span class="at">values =</span> <span class="st">"bookValue"</span>)</span>
<span id="cb36-159"><a href="#cb36-159" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>sample</span>
<span id="cb36-160"><a href="#cb36-160" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-161"><a href="#cb36-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-162"><a href="#cb36-162" aria-hidden="true" tabindex="-1"></a><span class="fu">### Fixed Interval Sampling</span></span>
<span id="cb36-163"><a href="#cb36-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-164"><a href="#cb36-164" aria-hidden="true" tabindex="-1"></a>Fixed interval sampling is a method designed for yielding representative samples from monetary populations. The algorithm determines a uniform interval on the (optionally ranked) sampling units. Next, a starting point is handpicked or randomly selected in the first interval and a sampling unit is selected throughout the population at each of the uniform intervals from the starting point. For example, if the interval has a width of 10 sampling units and sampling unit number 5 is chosen as the starting point, the sampling units 5, 15, 25, etc. are selected to be included in the sample.</span>
<span id="cb36-165"><a href="#cb36-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-166"><a href="#cb36-166" aria-hidden="true" tabindex="-1"></a>The number of required intervals $I$ can be determined by dividing the number of sampling units in the population by the required sample size:</span>
<span id="cb36-167"><a href="#cb36-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-168"><a href="#cb36-168" aria-hidden="true" tabindex="-1"></a>\begin{equation}</span>
<span id="cb36-169"><a href="#cb36-169" aria-hidden="true" tabindex="-1"></a>  I = \frac{N}{n},</span>
<span id="cb36-170"><a href="#cb36-170" aria-hidden="true" tabindex="-1"></a>\end{equation}</span>
<span id="cb36-171"><a href="#cb36-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-172"><a href="#cb36-172" aria-hidden="true" tabindex="-1"></a>in which $n$ is the required sample size and $N$ is the total number of sampling units in the population.</span>
<span id="cb36-173"><a href="#cb36-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-174"><a href="#cb36-174" aria-hidden="true" tabindex="-1"></a>If the space between the selected sampling units is equal, the selection probability for each sampling unit is theoretically defined as:</span>
<span id="cb36-175"><a href="#cb36-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-176"><a href="#cb36-176" aria-hidden="true" tabindex="-1"></a>\begin{equation}</span>
<span id="cb36-177"><a href="#cb36-177" aria-hidden="true" tabindex="-1"></a>  p(x) = \frac{1}{I},</span>
<span id="cb36-178"><a href="#cb36-178" aria-hidden="true" tabindex="-1"></a>\end{equation}</span>
<span id="cb36-179"><a href="#cb36-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-180"><a href="#cb36-180" aria-hidden="true" tabindex="-1"></a>with the property that the space between selected units $i$ (of which the first one is the starting point) is the same as the interval $I$, see @#fig-selection-interval below. However, in practice the selection is deterministic and completely depends on the chosen starting points (using <span class="in">`start`</span>).</span>
<span id="cb36-181"><a href="#cb36-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-182"><a href="#cb36-182" aria-hidden="true" tabindex="-1"></a><span class="al">![Illustration of fixed interval sampling. The population is represented by the horizontal line, and the vertical lines indicate the intervals of size $I$ at which samples units are selected. By using fixed interval sampling, equal spacing between sampling units is ensures, which means that every $\text{i}^{\text{th}}$ unit in the population is included in the sample.](img/selection_interval.png)</span>{#fig-selection-interval fig-align="center"}</span>
<span id="cb36-183"><a href="#cb36-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-184"><a href="#cb36-184" aria-hidden="true" tabindex="-1"></a>The fixed interval method yields a sample that allows every sampling unit in the population an equal chance of being selected. However, the fixed interval method has the property that all items in the population with a monetary value larger than the interval $I$ have an selection probability of one because one of these items' sampling units are always selected from the interval. Note that, if the population is arranged randomly with respect to its deviation pattern, fixed interval sampling is equivalent to random selection.</span>
<span id="cb36-185"><a href="#cb36-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-186"><a href="#cb36-186" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Advantage(s):** The advantage of the fixed interval sampling method is that it is often simple to understand and fast to perform. Another advantage is that, in monetary unit sampling, all items that are greater than the calculated interval will be included in the sample. In record sampling, since units can be ranked on the basis of value, there is also a guarantee that some large items will be in the sample.</span>
<span id="cb36-187"><a href="#cb36-187" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Disadvantage(s):** A pattern in the population can coincide with the selected interval, rendering the sample less representative. What is sometimes seen as an added complication for this method is that the sample is hard to extend after drawing the initial sample. This is due to the chance of selecting the same sampling unit. However, by removing the already selected sampling units from the population and redrawing the intervals this problem can be efficiently solved.</span>
<span id="cb36-188"><a href="#cb36-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-189"><a href="#cb36-189" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Record Sampling</span></span>
<span id="cb36-190"><a href="#cb36-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-191"><a href="#cb36-191" aria-hidden="true" tabindex="-1"></a>To code fixed interval sampling in a record sampling context, we first have to compute the size of the interval we are working with. This is computed by dividing the number of items in the population by the desired sample size $n$. Suppose the auditor wants to select a sample of 10 items, then the interval is computed by:</span>
<span id="cb36-192"><a href="#cb36-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-195"><a href="#cb36-195" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-196"><a href="#cb36-196" aria-hidden="true" tabindex="-1"></a>interval <span class="ot">&lt;-</span> <span class="fu">nrow</span>(BuildIt) <span class="sc">/</span> n</span>
<span id="cb36-197"><a href="#cb36-197" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-198"><a href="#cb36-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-199"><a href="#cb36-199" aria-hidden="true" tabindex="-1"></a>Next, we have to determine the starting point. We are going to take the fifth unit in each interval in this case.</span>
<span id="cb36-200"><a href="#cb36-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-203"><a href="#cb36-203" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-204"><a href="#cb36-204" aria-hidden="true" tabindex="-1"></a>start <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb36-205"><a href="#cb36-205" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-206"><a href="#cb36-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-207"><a href="#cb36-207" aria-hidden="true" tabindex="-1"></a>To find which rows are part of the sample, we execute the following code:</span>
<span id="cb36-208"><a href="#cb36-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-211"><a href="#cb36-211" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-212"><a href="#cb36-212" aria-hidden="true" tabindex="-1"></a>items <span class="ot">&lt;-</span> <span class="fu">floor</span>(start <span class="sc">+</span> interval <span class="sc">*</span> <span class="dv">0</span><span class="sc">:</span>(n <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb36-213"><a href="#cb36-213" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-214"><a href="#cb36-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-215"><a href="#cb36-215" aria-hidden="true" tabindex="-1"></a>You can then select the sample from the population using the selected indices stored in <span class="in">`items`</span>.</span>
<span id="cb36-216"><a href="#cb36-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-219"><a href="#cb36-219" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-220"><a href="#cb36-220" aria-hidden="true" tabindex="-1"></a>BuildIt[items, ]</span>
<span id="cb36-221"><a href="#cb36-221" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-222"><a href="#cb36-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-223"><a href="#cb36-223" aria-hidden="true" tabindex="-1"></a>The sample can be reproduced in **jfa** via the <span class="in">`selection()`</span> function. The argument <span class="in">`units`</span> allows you to specify that you want to use record sampling (<span class="in">`units = "items"`</span>), while the <span class="in">`method`</span> argument enables you to specify that you are performing fixed interval sampling (<span class="in">`method = 'interval'`</span>). Note that, by default, the first sampling unit from each interval is selected. However, this can be changed by setting the argument <span class="in">`start`</span> to a different value.</span>
<span id="cb36-224"><a href="#cb36-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-227"><a href="#cb36-227" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-228"><a href="#cb36-228" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">selection</span>(<span class="at">data =</span> BuildIt, <span class="at">size =</span> n, <span class="at">units =</span> <span class="st">"items"</span>, <span class="at">method =</span> <span class="st">"interval"</span>, <span class="at">start =</span> start)</span>
<span id="cb36-229"><a href="#cb36-229" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>sample</span>
<span id="cb36-230"><a href="#cb36-230" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-231"><a href="#cb36-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-232"><a href="#cb36-232" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Monetary Unit Sampling</span></span>
<span id="cb36-233"><a href="#cb36-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-234"><a href="#cb36-234" aria-hidden="true" tabindex="-1"></a>In monetary unit sampling, the only difference is that we are computing the interval on the basis of the booked values in the column <span class="in">`bookValue`</span> of the data set. In this case, the starting point <span class="in">`start = 5`</span> determines which monetary unit from each interval is selected.</span>
<span id="cb36-235"><a href="#cb36-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-238"><a href="#cb36-238" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-239"><a href="#cb36-239" aria-hidden="true" tabindex="-1"></a>interval <span class="ot">&lt;-</span> <span class="fu">sum</span>(BuildIt<span class="sc">$</span>bookValue) <span class="sc">/</span> n</span>
<span id="cb36-240"><a href="#cb36-240" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-241"><a href="#cb36-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-242"><a href="#cb36-242" aria-hidden="true" tabindex="-1"></a>To find which units are part of the sample, we execute the following code:</span>
<span id="cb36-243"><a href="#cb36-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-246"><a href="#cb36-246" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-247"><a href="#cb36-247" aria-hidden="true" tabindex="-1"></a>units <span class="ot">&lt;-</span> <span class="fu">floor</span>(start <span class="sc">+</span> interval <span class="sc">*</span> <span class="dv">0</span><span class="sc">:</span>(n <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb36-248"><a href="#cb36-248" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-249"><a href="#cb36-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-250"><a href="#cb36-250" aria-hidden="true" tabindex="-1"></a>To obtain which items are part of the sample, we can run the following for loop. Note that this does not take into account whether the book values contain negative values, which should not be included in the cumulative sum below.</span>
<span id="cb36-251"><a href="#cb36-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-254"><a href="#cb36-254" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-255"><a href="#cb36-255" aria-hidden="true" tabindex="-1"></a>all_units <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(BuildIt<span class="sc">$</span>bookValue <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="dv">0</span>, BuildIt<span class="sc">$</span>bookValue)</span>
<span id="cb36-256"><a href="#cb36-256" aria-hidden="true" tabindex="-1"></a>all_items <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(BuildIt)</span>
<span id="cb36-257"><a href="#cb36-257" aria-hidden="true" tabindex="-1"></a>items <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb36-258"><a href="#cb36-258" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb36-259"><a href="#cb36-259" aria-hidden="true" tabindex="-1"></a>  item <span class="ot">&lt;-</span> <span class="fu">which</span>(units[i] <span class="sc">&lt;=</span> <span class="fu">cumsum</span>(all_units))[<span class="dv">1</span>]</span>
<span id="cb36-260"><a href="#cb36-260" aria-hidden="true" tabindex="-1"></a>  items[i] <span class="ot">&lt;-</span> all_items[item]</span>
<span id="cb36-261"><a href="#cb36-261" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-262"><a href="#cb36-262" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-263"><a href="#cb36-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-264"><a href="#cb36-264" aria-hidden="true" tabindex="-1"></a>You can then select the sample from the population using the selected indices stored in <span class="in">`items`</span>.</span>
<span id="cb36-265"><a href="#cb36-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-268"><a href="#cb36-268" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-269"><a href="#cb36-269" aria-hidden="true" tabindex="-1"></a>BuildIt[items, ]</span>
<span id="cb36-270"><a href="#cb36-270" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-271"><a href="#cb36-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-272"><a href="#cb36-272" aria-hidden="true" tabindex="-1"></a>The sample can be reproduced in **jfa** via the <span class="in">`selection()`</span> function. The argument <span class="in">`units`</span> allows you to specify that you want to use monetary unit sampling (<span class="in">`units = "values"`</span>), while the <span class="in">`method`</span> argument enables you to specify that you are performing fixed interval sampling (<span class="in">`method = 'interval'`</span>). Note that you should provide the name of the column in the data that contains the monetary units via the <span class="in">`values`</span> argument.</span>
<span id="cb36-273"><a href="#cb36-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-276"><a href="#cb36-276" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-277"><a href="#cb36-277" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">selection</span>(<span class="at">data =</span> BuildIt, <span class="at">size =</span> n, <span class="at">units =</span> <span class="st">"values"</span>, <span class="at">method =</span> <span class="st">"interval"</span>, <span class="at">values =</span> <span class="st">"bookValue"</span>, <span class="at">start =</span> start)</span>
<span id="cb36-278"><a href="#cb36-278" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>sample</span>
<span id="cb36-279"><a href="#cb36-279" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-280"><a href="#cb36-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-281"><a href="#cb36-281" aria-hidden="true" tabindex="-1"></a><span class="fu">### Cell Sampling</span></span>
<span id="cb36-282"><a href="#cb36-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-283"><a href="#cb36-283" aria-hidden="true" tabindex="-1"></a>The cell sampling method divides the (optionally ranked) population into a set of intervals $I$ that are computed through the previously given equations. Within each interval, a sampling unit is selected by randomly drawing a number between 1 and the interval range $I$. This causes the space $i$ between the sampling units to vary. The procedure is displayed in @#fig-selection-cell.</span>
<span id="cb36-284"><a href="#cb36-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-285"><a href="#cb36-285" aria-hidden="true" tabindex="-1"></a>Like in the fixed interval sampling method, the selection probability for each sampling unit is defined as:</span>
<span id="cb36-286"><a href="#cb36-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-287"><a href="#cb36-287" aria-hidden="true" tabindex="-1"></a>\begin{equation}</span>
<span id="cb36-288"><a href="#cb36-288" aria-hidden="true" tabindex="-1"></a>  p(x) = \frac{1}{I}.</span>
<span id="cb36-289"><a href="#cb36-289" aria-hidden="true" tabindex="-1"></a>\end{equation}</span>
<span id="cb36-290"><a href="#cb36-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-291"><a href="#cb36-291" aria-hidden="true" tabindex="-1"></a><span class="al">![Illustration of cell sampling. In this illustration, the population is fist divided into distinct cells of size $I$ and subsequently a random sampling unit is selected within each cell such that the space between units $i$ varies.](img/selection_cell.png)</span>{#fig-selection-cell fig-align="center"}</span>
<span id="cb36-292"><a href="#cb36-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-293"><a href="#cb36-293" aria-hidden="true" tabindex="-1"></a>The cell sampling method has the property that all items in the population with a monetary value larger than twice the interval $I$ have a selection probability of one.</span>
<span id="cb36-294"><a href="#cb36-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-295"><a href="#cb36-295" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Advantage(s):** More sets of samples are possible than in fixed interval sampling, as there is no systematic interval $i$ to determine the selections. It is argued that the cell sampling algorithm offers a solution to the pattern problem in fixed interval sampling.</span>
<span id="cb36-296"><a href="#cb36-296" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Disadvantage(s):** A disadvantage of this sampling method is that not all items in the population with a monetary value larger than the interval have a selection probability of one. Besides, population items can be in two adjacent cells, thereby creating the possibility that an items is included in the sample twice.</span>
<span id="cb36-297"><a href="#cb36-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-298"><a href="#cb36-298" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Record Sampling</span></span>
<span id="cb36-299"><a href="#cb36-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-300"><a href="#cb36-300" aria-hidden="true" tabindex="-1"></a>To code cell sampling in a record sampling context, we again have to compute the size of the interval we are working with:</span>
<span id="cb36-301"><a href="#cb36-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-304"><a href="#cb36-304" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-305"><a href="#cb36-305" aria-hidden="true" tabindex="-1"></a>interval <span class="ot">&lt;-</span> <span class="fu">nrow</span>(BuildIt) <span class="sc">/</span> n</span>
<span id="cb36-306"><a href="#cb36-306" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-307"><a href="#cb36-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-308"><a href="#cb36-308" aria-hidden="true" tabindex="-1"></a>Next, we have to randomly determine which items are going to be selected in each interval.</span>
<span id="cb36-309"><a href="#cb36-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-312"><a href="#cb36-312" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-313"><a href="#cb36-313" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb36-314"><a href="#cb36-314" aria-hidden="true" tabindex="-1"></a>starts <span class="ot">&lt;-</span> <span class="fu">floor</span>(<span class="fu">runif</span>(n, <span class="dv">0</span>, interval))</span>
<span id="cb36-315"><a href="#cb36-315" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-316"><a href="#cb36-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-317"><a href="#cb36-317" aria-hidden="true" tabindex="-1"></a>To find which rows are part of the sample, we execute the following code:</span>
<span id="cb36-318"><a href="#cb36-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-321"><a href="#cb36-321" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-322"><a href="#cb36-322" aria-hidden="true" tabindex="-1"></a>items <span class="ot">&lt;-</span> <span class="fu">floor</span>(starts <span class="sc">+</span> interval <span class="sc">*</span> <span class="dv">0</span><span class="sc">:</span>(n <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb36-323"><a href="#cb36-323" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-324"><a href="#cb36-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-325"><a href="#cb36-325" aria-hidden="true" tabindex="-1"></a>You can then select the sample from the population using the selected indices stored in <span class="in">`items`</span>.</span>
<span id="cb36-326"><a href="#cb36-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-329"><a href="#cb36-329" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-330"><a href="#cb36-330" aria-hidden="true" tabindex="-1"></a>BuildIt[items, ]</span>
<span id="cb36-331"><a href="#cb36-331" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-332"><a href="#cb36-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-333"><a href="#cb36-333" aria-hidden="true" tabindex="-1"></a>The sample can be reproduced in **jfa** via the <span class="in">`selection()`</span> function. The argument <span class="in">`units`</span> allows you to specify that you want to use record sampling (<span class="in">`units = "items"`</span>), while the <span class="in">`method`</span> argument enables you to specify that you are performing cell sampling (<span class="in">`method = 'cell'`</span>).</span>
<span id="cb36-334"><a href="#cb36-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-337"><a href="#cb36-337" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-338"><a href="#cb36-338" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb36-339"><a href="#cb36-339" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">selection</span>(<span class="at">data =</span> BuildIt, <span class="at">size =</span> n, <span class="at">units =</span> <span class="st">"items"</span>, <span class="at">method =</span> <span class="st">"cell"</span>)</span>
<span id="cb36-340"><a href="#cb36-340" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>sample</span>
<span id="cb36-341"><a href="#cb36-341" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-342"><a href="#cb36-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-343"><a href="#cb36-343" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Monetary Unit Sampling</span></span>
<span id="cb36-344"><a href="#cb36-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-345"><a href="#cb36-345" aria-hidden="true" tabindex="-1"></a>In monetary unit sampling, the only difference is that we are computing the interval on the basis of the booked values in the column <span class="in">`bookValue`</span> of the data set. In this case, the starting points <span class="in">`start`</span> determines which monetary unit from each interval is selected.</span>
<span id="cb36-346"><a href="#cb36-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-349"><a href="#cb36-349" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-350"><a href="#cb36-350" aria-hidden="true" tabindex="-1"></a>interval <span class="ot">&lt;-</span> <span class="fu">sum</span>(BuildIt<span class="sc">$</span>bookValue) <span class="sc">/</span> n</span>
<span id="cb36-351"><a href="#cb36-351" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-352"><a href="#cb36-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-353"><a href="#cb36-353" aria-hidden="true" tabindex="-1"></a>To obtain which items are part of the sample, we can run the following for loop. Note that this does not take into account whether the book values contain negative values, which should not be included in the cumulative sum below.</span>
<span id="cb36-354"><a href="#cb36-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-357"><a href="#cb36-357" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-358"><a href="#cb36-358" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb36-359"><a href="#cb36-359" aria-hidden="true" tabindex="-1"></a>all_units <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(BuildIt<span class="sc">$</span>bookValue <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="dv">0</span>, BuildIt<span class="sc">$</span>bookValue)</span>
<span id="cb36-360"><a href="#cb36-360" aria-hidden="true" tabindex="-1"></a>all_items <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(BuildIt)</span>
<span id="cb36-361"><a href="#cb36-361" aria-hidden="true" tabindex="-1"></a>intervals <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span>n <span class="sc">*</span> interval</span>
<span id="cb36-362"><a href="#cb36-362" aria-hidden="true" tabindex="-1"></a>items <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb36-363"><a href="#cb36-363" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb36-364"><a href="#cb36-364" aria-hidden="true" tabindex="-1"></a>  unit <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">runif</span>(<span class="dv">1</span>, intervals[i], intervals[i <span class="sc">+</span> <span class="dv">1</span>])</span>
<span id="cb36-365"><a href="#cb36-365" aria-hidden="true" tabindex="-1"></a>  item <span class="ot">&lt;-</span> <span class="fu">which</span>(unit <span class="sc">&lt;=</span> <span class="fu">cumsum</span>(all_units))[<span class="dv">1</span>]</span>
<span id="cb36-366"><a href="#cb36-366" aria-hidden="true" tabindex="-1"></a>  items[i] <span class="ot">&lt;-</span> all_items[item]</span>
<span id="cb36-367"><a href="#cb36-367" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-368"><a href="#cb36-368" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-369"><a href="#cb36-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-370"><a href="#cb36-370" aria-hidden="true" tabindex="-1"></a>You can then select the sample from the population using the selected indices stored in <span class="in">`items`</span>.</span>
<span id="cb36-371"><a href="#cb36-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-374"><a href="#cb36-374" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-375"><a href="#cb36-375" aria-hidden="true" tabindex="-1"></a>BuildIt[items, ]</span>
<span id="cb36-376"><a href="#cb36-376" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-377"><a href="#cb36-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-378"><a href="#cb36-378" aria-hidden="true" tabindex="-1"></a>The sample can be reproduced in **jfa** via the <span class="in">`selection()`</span> function. The argument <span class="in">`units`</span> allows you to specify that you want to use monetary unit sampling (<span class="in">`units = "values"`</span>), while the <span class="in">`method`</span> argument enables you to specify that you are performing cell sampling (<span class="in">`method = 'cell'`</span>). Note that you should provide the name of the column in the data that contains the monetary units via the <span class="in">`values`</span> argument.</span>
<span id="cb36-379"><a href="#cb36-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-382"><a href="#cb36-382" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-383"><a href="#cb36-383" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb36-384"><a href="#cb36-384" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">selection</span>(<span class="at">data =</span> BuildIt, <span class="at">size =</span> n, <span class="at">units =</span> <span class="st">"values"</span>, <span class="at">method =</span> <span class="st">"cell"</span>, <span class="at">values =</span> <span class="st">"bookValue"</span>)</span>
<span id="cb36-385"><a href="#cb36-385" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>sample</span>
<span id="cb36-386"><a href="#cb36-386" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-387"><a href="#cb36-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-388"><a href="#cb36-388" aria-hidden="true" tabindex="-1"></a><span class="fu">### Modified Sieve Sampling</span></span>
<span id="cb36-389"><a href="#cb36-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-390"><a href="#cb36-390" aria-hidden="true" tabindex="-1"></a>The fourth option for the sampling method is modified sieve sampling (Hoogduin, Hall, &amp; Tsay, 2010). The algorithm starts by selecting a standard uniform random number $R_i$ between 0 and 1 for each item in the population. Next, the sieve ratio:</span>
<span id="cb36-391"><a href="#cb36-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-392"><a href="#cb36-392" aria-hidden="true" tabindex="-1"></a>\begin{equation}</span>
<span id="cb36-393"><a href="#cb36-393" aria-hidden="true" tabindex="-1"></a>  S_i = \frac{Y_i}{R_i}</span>
<span id="cb36-394"><a href="#cb36-394" aria-hidden="true" tabindex="-1"></a>\end{equation}</span>
<span id="cb36-395"><a href="#cb36-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-396"><a href="#cb36-396" aria-hidden="true" tabindex="-1"></a>is computed for each item by dividing the book value of that item by the random number. Lastly, the items in the population are sorted by their sieve ratio $S$ (in decreasing order) and the top $n$ items are selected for inspection. In contrast to the classical sieve sampling method (Rietveld, 1978), the modified sieve sampling method provides precise control over sample sizes.</span>
<span id="cb36-397"><a href="#cb36-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-398"><a href="#cb36-398" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Monetary Unit Sampling</span></span>
<span id="cb36-399"><a href="#cb36-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-402"><a href="#cb36-402" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-403"><a href="#cb36-403" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb36-404"><a href="#cb36-404" aria-hidden="true" tabindex="-1"></a>all_units <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(BuildIt<span class="sc">$</span>bookValue <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="dv">0</span>, BuildIt<span class="sc">$</span>bookValue)</span>
<span id="cb36-405"><a href="#cb36-405" aria-hidden="true" tabindex="-1"></a>all_items <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(BuildIt)</span>
<span id="cb36-406"><a href="#cb36-406" aria-hidden="true" tabindex="-1"></a>ri <span class="ot">&lt;-</span> all_units <span class="sc">/</span> stats<span class="sc">::</span><span class="fu">runif</span>(<span class="fu">length</span>(all_items), <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb36-407"><a href="#cb36-407" aria-hidden="true" tabindex="-1"></a>items <span class="ot">&lt;-</span> all_items[<span class="fu">order</span>(<span class="sc">-</span>ri)]</span>
<span id="cb36-408"><a href="#cb36-408" aria-hidden="true" tabindex="-1"></a>items <span class="ot">&lt;-</span> items[<span class="dv">1</span><span class="sc">:</span>n]</span>
<span id="cb36-409"><a href="#cb36-409" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-410"><a href="#cb36-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-411"><a href="#cb36-411" aria-hidden="true" tabindex="-1"></a>You can then select the sample from the population using the selected indices stored in <span class="in">`items`</span>.</span>
<span id="cb36-412"><a href="#cb36-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-415"><a href="#cb36-415" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-416"><a href="#cb36-416" aria-hidden="true" tabindex="-1"></a>BuildIt[items, ]</span>
<span id="cb36-417"><a href="#cb36-417" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-418"><a href="#cb36-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-419"><a href="#cb36-419" aria-hidden="true" tabindex="-1"></a>The sample can be reproduced in **jfa** via the <span class="in">`selection()`</span> function. The argument <span class="in">`units`</span> allows you to specify that you want to use monetary unit sampling (<span class="in">`units = "values"`</span>), while the <span class="in">`method`</span> argument enables you to specify that you are performing modified sieve sampling (<span class="in">`method = 'sieve'`</span>). Note that you should provide the name of the column in the data that contains the monetary units via the <span class="in">`values`</span> argument.</span>
<span id="cb36-420"><a href="#cb36-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-423"><a href="#cb36-423" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-424"><a href="#cb36-424" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb36-425"><a href="#cb36-425" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">selection</span>(<span class="at">data =</span> BuildIt, <span class="at">size =</span> n, <span class="at">units =</span> <span class="st">"values"</span>, <span class="at">method =</span> <span class="st">"sieve"</span>, <span class="at">values =</span> <span class="st">"bookValue"</span>)</span>
<span id="cb36-426"><a href="#cb36-426" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>sample</span>
<span id="cb36-427"><a href="#cb36-427" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-428"><a href="#cb36-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-429"><a href="#cb36-429" aria-hidden="true" tabindex="-1"></a><span class="fu">## Practical Exercises</span></span>
<span id="cb36-430"><a href="#cb36-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-431"><a href="#cb36-431" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Select a random sample of 120 items from the <span class="in">`BuildIt`</span> data set.</span>
<span id="cb36-432"><a href="#cb36-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-433"><a href="#cb36-433" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="html"}</span>
<span id="cb36-434"><a href="#cb36-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-435"><a href="#cb36-435" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;details&gt;</span></span>
<span id="cb36-436"><a href="#cb36-436" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;summary&gt;</span>Click to reveal answer<span class="kw">&lt;/summary&gt;</span></span>
<span id="cb36-437"><a href="#cb36-437" aria-hidden="true" tabindex="-1"></a>Selecting a random sample of items can be done using the <span class="in">`selection()`</span> function with the additional arguments <span class="in">`size = 120`</span>, <span class="in">`method = "random"`</span> and <span class="in">`units = "items"`</span>.</span>
<span id="cb36-440"><a href="#cb36-440" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-441"><a href="#cb36-441" aria-hidden="true" tabindex="-1"></a>selec <span class="ot">&lt;-</span> <span class="fu">selection</span>(<span class="at">data =</span> BuildIt, <span class="at">size =</span> <span class="dv">120</span>, <span class="at">method =</span> <span class="st">"random"</span>, <span class="at">units =</span> <span class="st">"items"</span>)</span>
<span id="cb36-442"><a href="#cb36-442" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(selec<span class="sc">$</span>sample, <span class="dv">5</span>)</span>
<span id="cb36-443"><a href="#cb36-443" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-444"><a href="#cb36-444" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/details&gt;</span></span>
<span id="cb36-445"><a href="#cb36-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-446"><a href="#cb36-446" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb36-447"><a href="#cb36-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-448"><a href="#cb36-448" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Select a sample of 240 monetary units from the <span class="in">`BuildIt`</span> data set using a fixed interval selection method. Use a starting point of 12.</span>
<span id="cb36-449"><a href="#cb36-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-450"><a href="#cb36-450" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="html"}</span>
<span id="cb36-451"><a href="#cb36-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-452"><a href="#cb36-452" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;details&gt;</span></span>
<span id="cb36-453"><a href="#cb36-453" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;summary&gt;</span>Click to reveal answer<span class="kw">&lt;/summary&gt;</span></span>
<span id="cb36-454"><a href="#cb36-454" aria-hidden="true" tabindex="-1"></a>Selecting a random sample of items can be done using the <span class="in">`selection()`</span> function with the arguments <span class="in">`size = 240`</span>, <span class="in">`method = "interval"`</span> and <span class="in">`units = "values"`</span>. Additionally, for fixed interval monetary unit sampling, the book values must be given in via argument <span class="in">`values = "bookValue"`</span>. The starting point is indicated using <span class="in">`start = 12`</span>.</span>
<span id="cb36-457"><a href="#cb36-457" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-458"><a href="#cb36-458" aria-hidden="true" tabindex="-1"></a>selec <span class="ot">&lt;-</span> <span class="fu">selection</span>(<span class="at">data =</span> BuildIt, <span class="at">size =</span> <span class="dv">240</span>, <span class="at">method =</span> <span class="st">"interval"</span>, <span class="at">units =</span> <span class="st">"values"</span>, <span class="at">values =</span> <span class="st">"bookValue"</span>, <span class="at">start =</span> <span class="dv">12</span>)</span>
<span id="cb36-459"><a href="#cb36-459" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(selec<span class="sc">$</span>sample, <span class="dv">5</span>)</span>
<span id="cb36-460"><a href="#cb36-460" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-461"><a href="#cb36-461" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/details&gt;</span></span>
<span id="cb36-462"><a href="#cb36-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-463"><a href="#cb36-463" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb36-464"><a href="#cb36-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-465"><a href="#cb36-465" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="pdf"}</span>
<span id="cb36-466"><a href="#cb36-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-467"><a href="#cb36-467" aria-hidden="true" tabindex="-1"></a>\clearpage</span>
<span id="cb36-468"><a href="#cb36-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-469"><a href="#cb36-469" aria-hidden="true" tabindex="-1"></a><span class="fu">## Answers to the Exercises</span></span>
<span id="cb36-470"><a href="#cb36-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-471"><a href="#cb36-471" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Selecting a random sample of 120 items can be done using the <span class="in">`selection()`</span> function with the additional arguments <span class="in">`size = 120`</span>, <span class="in">`method = "random"`</span> and <span class="in">`units = "items"`</span>.</span>
<span id="cb36-472"><a href="#cb36-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-475"><a href="#cb36-475" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-476"><a href="#cb36-476" aria-hidden="true" tabindex="-1"></a>selec <span class="ot">&lt;-</span> <span class="fu">selection</span>(<span class="at">data =</span> BuildIt, <span class="at">size =</span> <span class="dv">120</span>, <span class="at">method =</span> <span class="st">"random"</span>, <span class="at">units =</span> <span class="st">"items"</span>)</span>
<span id="cb36-477"><a href="#cb36-477" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(selec<span class="sc">$</span>sample, <span class="dv">5</span>)</span>
<span id="cb36-478"><a href="#cb36-478" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-479"><a href="#cb36-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-480"><a href="#cb36-480" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Selecting a random sample of 240 monetary units can be done using the <span class="in">`selection()`</span> function with the arguments <span class="in">`size = 240`</span>, <span class="in">`method = "interval"`</span> and <span class="in">`units = "values"`</span>. Additionally, for fixed interval monetary unit sampling, the book values must be given in via argument <span class="in">`values = "bookValue"`</span>. The starting point is indicated using <span class="in">`start = 12`</span>.</span>
<span id="cb36-481"><a href="#cb36-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-484"><a href="#cb36-484" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb36-485"><a href="#cb36-485" aria-hidden="true" tabindex="-1"></a>selec <span class="ot">&lt;-</span> <span class="fu">selection</span>(<span class="at">data =</span> BuildIt, <span class="at">size =</span> <span class="dv">240</span>, <span class="at">method =</span> <span class="st">"interval"</span>, <span class="at">units =</span> <span class="st">"values"</span>, <span class="at">values =</span> <span class="st">"bookValue"</span>, <span class="at">start =</span> <span class="dv">12</span>)</span>
<span id="cb36-486"><a href="#cb36-486" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(selec<span class="sc">$</span>sample, <span class="dv">5</span>)</span>
<span id="cb36-487"><a href="#cb36-487" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-488"><a href="#cb36-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-489"><a href="#cb36-489" aria-hidden="true" tabindex="-1"></a>:::</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">This book was built with <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>


<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>